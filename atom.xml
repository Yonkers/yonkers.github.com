<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Leeo's Blog]]></title>
  <link href="http://yonkers.github.io/atom.xml" rel="self"/>
  <link href="http://yonkers.github.io/"/>
  <updated>2014-07-17T22:34:18+08:00</updated>
  <id>http://yonkers.github.io/</id>
  <author>
    <name><![CDATA[Leeo]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Androidä¸­Activityæ˜¯å¦‚ä½•å¯¼è‡´å†…å­˜æ³„æ¼çš„ï¼šHandler ä¸ Inner Calass(å†…éƒ¨ç±»)]]></title>
    <link href="http://yonkers.github.io/blog/2014/07/17/inner-class-handler-memory-leak/"/>
    <updated>2014-07-17T21:13:15+08:00</updated>
    <id>http://yonkers.github.io/blog/2014/07/17/inner-class-handler-memory-leak</id>
    <content type="html"><![CDATA[<p>é¦–å…ˆæ€è€ƒä¸‹é¢çš„ä»£ç ï¼š</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleActivity</span> <span class="kd">extends</span> <span class="n">Activity</span> <span class="o">{</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">private</span> <span class="kd">final</span> <span class="n">Handler</span> <span class="n">mLeakyHandler</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Handler</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>    <span class="nd">@Override</span>
</span><span class='line'>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handleMessage</span><span class="o">(</span><span class="n">Message</span> <span class="n">msg</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="c1">// ... </span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>è™½ç„¶ä¸æ˜¯å¾ˆæ˜æ˜¾ï¼Œä½†æ˜¯è¿™æ®µä»£ç çš„ç¡®ä¼šå¯¼è‡´ä¸¥é‡çš„å†…å­˜æ³„æ¼ï¼ŒAndroidä¼šç»™å‡ºå¦‚ä¸‹çš„è­¦å‘Š:</p>

<blockquote><p>åœ¨Androidä¸­ï¼ŒHandlerç±»éœ€è¦å®šä¹‰ä¸ºstaticï¼Œå¦åˆ™å¯èƒ½ä¼šå¯¼è‡´å†…å­˜æ³„æ¼ã€‚</p></blockquote>

<p>ä½†æ˜¯å“ªé‡Œä¼šå¯¼è‡´æ³„æ¼ï¼Œæ³„æ¼æ˜¯å¦‚ä½•äº§ç”Ÿçš„å‘¢ï¼Ÿè®©æˆ‘é—¨é¦–å…ˆé˜…è¯»ä¸‹é¢çš„æ–‡æ¡£ï¼š</p>

<p>å½“Androidåº”ç”¨ç¨‹åºé¦–æ¬¡å¯åŠ¨ï¼Œç³»ç»Ÿä¼šä¸ºç¨‹åºä¸»çº¿ç¨‹åˆ›å»ºä¸€ä¸ªLooperå¯¹è±¡ï¼ŒLooperå®ç°äº†ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¾ªç¯å¤„ç†Messageã€‚ç¨‹åºä¸­æ‰€æœ‰é‡è¦çš„äº‹ä»¶ï¼ˆå¦‚è°ƒç”¨Activityçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼ŒæŒ‰é’®ç‚¹å‡»äº‹ä»¶ç­‰ï¼‰éƒ½æ˜¯åœ¨Messageå¯¹è±¡ä¸­ï¼Œè¿™äº›Messageå¯¹è±¡è¢«æ·»åŠ åˆ°äº†Looperçš„æ¶ˆæ¯é˜Ÿåˆ—é‡Œé¢å¹¶ä¸”ä¸€ä¸ªä¸€ä¸ªä¾æ¬¡æ‰§è¡Œã€‚ä¸»çº¿ç¨‹çš„Looperå­˜åœ¨äºåº”ç”¨ç¨‹åºçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸã€‚</p>

<!--more-->


<p>å½“ä¸€ä¸ªHandleråœ¨ä¸»çº¿ç¨‹å®ä¾‹åŒ–åï¼Œå®ƒå°±è¢«å…³è”åˆ°äº†Looperçš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼ŒLooperåœ¨å¤„ç†æ¶ˆæ¯æ—¶ä¸ºäº†èƒ½å¤Ÿè°ƒç”¨Hnadlerçš„<strong>handeMessage(Message)</strong>æ–¹æ³•ï¼Œæ‰€ä»¥æ¨é€åˆ°æ¶ˆæ¯é˜Ÿåˆ—çš„Messageä¼šæŒæœ‰ä¸€ä¸ªHandlerçš„å¼•ç”¨ã€‚</p>

<blockquote><p>åœ¨Javaä¸­ï¼Œéé™æ€å†…éƒ¨ç±»å’ŒåŒ¿åç±»ä¼šæŒæœ‰ä¸€ä¸ªå¤–éƒ¨ç±»çš„å¼•ç”¨ï¼Œè€Œé™æ€çš„å†…éƒ¨ç±»åˆ™ä¸ä¼šã€‚</p></blockquote>

<p>å› æ­¤ï¼Œå†…å­˜æ³„æ¼åˆ°åº•å‘ç”Ÿåœ¨å“ªå‘¢ï¼Ÿè™½ç„¶æ¯”è¾ƒéšè—ï¼Œä½†æ˜¯æ€è€ƒä¸‹é¢çš„ä»£ç ï¼š</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleActivity</span> <span class="kd">extends</span> <span class="n">Activity</span> <span class="o">{</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">private</span> <span class="kd">final</span> <span class="n">Handler</span> <span class="n">mLeakyHandler</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Handler</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>    <span class="nd">@Override</span>
</span><span class='line'>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handleMessage</span><span class="o">(</span><span class="n">Message</span> <span class="n">msg</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="c1">// ...</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nd">@Override</span>
</span><span class='line'>  <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>    <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// Post a message and delay its execution for 10 minutes.</span>
</span><span class='line'>    <span class="n">mLeakyHandler</span><span class="o">.</span><span class="na">postDelayed</span><span class="o">(</span><span class="k">new</span> <span class="n">Runnable</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>      <span class="nd">@Override</span>
</span><span class='line'>      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span> <span class="o">}</span>
</span><span class='line'>    <span class="o">},</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">*</span> <span class="mi">1000</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// Go back to the previous Activity.</span>
</span><span class='line'>    <span class="n">finish</span><span class="o">();</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>å½“Activityé”€æ¯æ—¶ï¼Œè¿™ä¸ªå»¶è¿Ÿæ‰§è¡Œçš„æ¶ˆæ¯åœ¨çœŸæ­£æ‰§è¡Œä¹‹å‰ä¼šåœ¨ä¸»çº¿ç¨‹çš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­å­˜åœ¨10åˆ†é’Ÿï¼Œè¿™ä¸ªæ¶ˆæ¯æŒæœ‰Handlerçš„å¼•ç”¨ï¼Œè€ŒHandleræŒæœ‰å®ƒçš„å¤–éƒ¨ç±»ï¼ˆSampleActivityï¼‰çš„å¼•ç”¨ã€‚è¿™ä¸ªå¼•ç”¨ä¼šä¸€ç›´å­˜åœ¨ç›´åˆ°æ¶ˆæ¯è¢«å¤„ç†ï¼Œè¿™ä¼šé˜»æ­¢åƒåœ¾å›æ”¶å™¨å›æ”¶activityä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œä»¥åŠç¨‹åºæ‰€æœ‰èµ„æºã€‚ä»£ç 15è¡Œä¸­åŒ¿åçš„Runnableå¯¹è±¡åŒæ ·ä¹Ÿæœ‰è¿™æ ·çš„é—®é¢˜ã€‚<strong>éé™æ€åŒ¿åç±»å¯¹è±¡ä¼šæŒæœ‰å…¶å¤–éƒ¨ç±»å¯¹è±¡çš„å¼•ç”¨ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´æ³„æ¼ã€‚</strong></p>

<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥å®šä¹‰Handleråœ¨ä¸€ä¸ªæ–°çš„æ–‡ä»¶ä¸­æˆ–è€…ä½¿ç”¨é™æ€å†…éƒ¨ç±»ã€‚é™æ€å†…éƒ¨ç±»ä¸ä¼šæŒæœ‰å¤–éƒ¨ç±»çš„å¼•ç”¨ï¼Œæ‰€ä»¥activityä¸ä¼šè¢«æ³„æ¼ã€‚å¦‚æœåœ¨Handlerä¸­éœ€è¦è°ƒç”¨å¤–éƒ¨Activityçš„æ–¹æ³•ï¼Œå¯ä»¥è®©HandleræŒæœ‰Activityçš„å¼±å¼•ç”¨ã€‚è¦è§£å†³å®ä¾‹åŒ–Runnableæ—¶å¯¼è‡´çš„å†…å­˜æ³„æ¼ï¼Œå¯ä»¥æŒ‡å®šrunnableå¯¹è±¡ä¸º<strong>static</strong>ï¼ˆå› ä¸ºé™æ€çš„åŒ¿åå¯¹è±¡ä¸ä¼šæŒæœ‰å¤–éƒ¨ç±»çš„å¼•ç”¨ï¼‰</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleActivity</span> <span class="kd">extends</span> <span class="n">Activity</span> <span class="o">{</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/**</span>
</span><span class='line'><span class="cm">   * Instances of static inner classes do not hold an implicit</span>
</span><span class='line'><span class="cm">   * reference to their outer class.</span>
</span><span class='line'><span class="cm">   */</span>
</span><span class='line'>  <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">MyHandler</span> <span class="kd">extends</span> <span class="n">Handler</span> <span class="o">{</span>
</span><span class='line'>    <span class="kd">private</span> <span class="kd">final</span> <span class="n">WeakReference</span><span class="o">&lt;</span><span class="n">SampleActivity</span><span class="o">&gt;</span> <span class="n">mActivity</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">public</span> <span class="nf">MyHandler</span><span class="o">(</span><span class="n">SampleActivity</span> <span class="n">activity</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">mActivity</span> <span class="o">=</span> <span class="k">new</span> <span class="n">WeakReference</span><span class="o">&lt;</span><span class="n">SampleActivity</span><span class="o">&gt;(</span><span class="n">activity</span><span class="o">);</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="nd">@Override</span>
</span><span class='line'>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handleMessage</span><span class="o">(</span><span class="n">Message</span> <span class="n">msg</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">SampleActivity</span> <span class="n">activity</span> <span class="o">=</span> <span class="n">mActivity</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
</span><span class='line'>      <span class="k">if</span> <span class="o">(</span><span class="n">activity</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>        <span class="c1">// ...</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">private</span> <span class="kd">final</span> <span class="n">MyHandler</span> <span class="n">mHandler</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyHandler</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/**</span>
</span><span class='line'><span class="cm">   * Instances of anonymous classes do not hold an implicit</span>
</span><span class='line'><span class="cm">   * reference to their outer class when they are &quot;static&quot;.</span>
</span><span class='line'><span class="cm">   */</span>
</span><span class='line'>  <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Runnable</span> <span class="n">sRunnable</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Runnable</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>      <span class="nd">@Override</span>
</span><span class='line'>      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span> <span class="o">}</span>
</span><span class='line'>  <span class="o">};</span>
</span><span class='line'>
</span><span class='line'>  <span class="nd">@Override</span>
</span><span class='line'>  <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>    <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// Post a message and delay its execution for 10 minutes.</span>
</span><span class='line'>    <span class="n">mHandler</span><span class="o">.</span><span class="na">postDelayed</span><span class="o">(</span><span class="n">sRunnable</span><span class="o">,</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">*</span> <span class="mi">1000</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// Go back to the previous Activity.</span>
</span><span class='line'>    <span class="n">finish</span><span class="o">();</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>è™½ç„¶é™æ€å†…éƒ¨ç±»å’Œéé™æ€å†…éƒ¨ç±»çš„åŒºåˆ«å¾ˆå°ï¼Œä½†æ˜¯ä½œä¸ºAandroidå¼€å‘è€…æ˜¯éœ€è¦äº†è§£çš„ã€‚åœ¨Activityä¸­ï¼Œå¦‚æœå†…éƒ¨ç±»å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸé•¿äºå…¶å¤–éƒ¨ç±»å¯¹è±¡ï¼Œé‚£ä¹ˆé¿å…ä½¿ç”¨éé™æ€å†…éƒ¨ç±»ï¼Œå¦åˆ™ä½¿ç”¨é™æ€å†…éƒ¨ç±»ï¼Œå¹¶è®©å…¶æŒæœ‰å¤–éƒ¨ç±»å¯¹è±¡çš„å¼±å¼•ç”¨ã€‚</p>

<p>æœ‰ä»»ä½•é—®é¢˜æ¬¢è¿ç•™è¨€ï¼</p>

<p>åŸæ–‡ï¼š<a href="http://www.androiddesignpatterns.com/2013/01/inner-class-handler-memory-leak.html">How to Leak a Context: Handlers &amp; Inner Classes</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[å¸¸ç”¨å·¥å…·é›†åˆ]]></title>
    <link href="http://yonkers.github.io/blog/2014/07/14/tools/"/>
    <updated>2014-07-14T20:51:22+08:00</updated>
    <id>http://yonkers.github.io/blog/2014/07/14/tools</id>
    <content type="html"><![CDATA[<h2>(ä¸€)åœ¨çº¿ç¼–è¾‘</h2>

<h3><strong>Markdown</strong>:</h3>

<ul>
<li><strong>Stackedit</strong>: <a href="https://stackedit.io"><code>https://stackedit.io</code></a></li>
</ul>


<h3><strong>Json</strong>:</h3>

<ul>
<li><a href="http://www.bejson.com/go.php?u=http://www.bejson.com/jsonviewernew/"><code>http://www.bejson.com/go.php?u=http://www.bejson.com/jsonviewernew/</code></a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Test for first blog]]></title>
    <link href="http://yonkers.github.io/blog/2014/07/12/test-for-first-blog/"/>
    <updated>2014-07-12T15:08:54+08:00</updated>
    <id>http://yonkers.github.io/blog/2014/07/12/test-for-first-blog</id>
    <content type="html"><![CDATA[<h4>åŸºäº<strong>Octopress</strong> <strong>å’ŒGithub</strong>å¾—åšå®¢ç»ˆäºæ­å»ºå¥½äº†ï¼Œå¼€å§‹è®°å½•å·¥ä½œç”Ÿæ´»ç‚¹æ»´ï¼ğŸ˜„ğŸ˜„ğŸ˜„</h4>

<p>å‚è€ƒåšæ–‡ï¼š</p>

<p><strong>1.<a href="http://msching.github.io/blog/2014/04/11/starting/" title="Title">åŸºäºGithubå’ŒOctopressæ­å»ºå±äºè‡ªå·±çš„åšå®¢</a></strong></p>

<p><strong>2.<a href="http://biaobiaoqi.me/blog/2013/07/10/decorate-octopress/" title="Title">å®šåˆ¶Octopress</a></strong></p>

<p><strong>3.<a href="http://blog.devtang.com/blog/2012/02/10/setup-blog-based-on-github/" title="Title">è±¡å†™ç¨‹åºä¸€æ ·å†™åšå®¢ï¼šæ­å»ºåŸºäºgithubçš„åšå®¢</a></strong></p>
]]></content>
  </entry>
  
</feed>
